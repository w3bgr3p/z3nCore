# Cryptography

Этот модуль предоставляет криптографические утилиты для шифрования, хеширования и операций кодирования.

---

## Класс AES

Статический класс, предоставляющий функциональность шифрования/дешифрования AES и хеширования MD5.

### EncryptAES

**Назначение**: Шифрует строку с использованием шифрования AES в режиме ECB с заполнением PKCS7.

**Пример**:
```csharp
// Зашифровать строку с автоматическим хешированием ключа
string plainText = "Hello World";
string key = "mySecretKey";
string encrypted = AES.EncryptAES(plainText, key);

// Зашифровать без хеширования ключа (ключ должен быть 32 шестнадцатеричных символа)
string encryptedNoHash = AES.EncryptAES(plainText, "0123456789ABCDEF0123456789ABCDEF", false);
```

**Разбор**:
```csharp
public static string EncryptAES(string phrase, string key, bool hashKey = true)

// Параметры:
// - phrase: Открытый текст для шифрования
// - key: Ключ шифрования (будет хеширован MD5, если hashKey = true)
// - hashKey: Если true, ключ будет хеширован MD5 перед использованием (по умолчанию: true)

// Возвращает:
// - Зашифрованную строку в шестнадцатеричном формате
// - Возвращает null, если phrase или key равны null

// Примечания:
// - Использует AES с режимом ECB и заполнением PKCS7
// - Результат возвращается в виде hex-строки
```

---

### DecryptAES

**Назначение**: Расшифровывает AES-зашифрованную шестнадцатеричную строку обратно в открытый текст.

**Пример**:
```csharp
// Расшифровать строку, зашифрованную с помощью EncryptAES
string encrypted = "4A6F686E..."; // hex строка
string key = "mySecretKey";
string decrypted = AES.DecryptAES(encrypted, key);

// Расшифровать без хеширования ключа
string decryptedNoHash = AES.DecryptAES(encrypted, "0123456789ABCDEF0123456789ABCDEF", false);
```

**Разбор**:
```csharp
public static string DecryptAES(string hash, string key, bool hashKey = true)

// Параметры:
// - hash: Зашифрованная шестнадцатеричная строка для расшифровки
// - key: Ключ расшифровки (тот же ключ, что использовался для шифрования)
// - hashKey: Если true, ключ будет хеширован MD5 перед использованием (по умолчанию: true)

// Возвращает:
// - Расшифрованную строку открытого текста
// - Возвращает null, если hash или key равны null

// Примечания:
// - Необходимо использовать ту же настройку hashKey, что и при шифровании
// - Входные данные должны быть корректной шестнадцатеричной строкой
```

---

### HashMD5

**Назначение**: Вычисляет MD5-хеш строки и возвращает его в виде шестнадцатеричной строки.

**Пример**:
```csharp
// Хешировать строку
string input = "myPassword123";
string hash = AES.HashMD5(input);
// Результат: "5F4DCC3B5AA765D61D8327DEB882CF99" (пример)
```

**Разбор**:
```csharp
public static string HashMD5(string phrase)

// Параметры:
// - phrase: Строка для хеширования

// Возвращает:
// - MD5 хеш в виде шестнадцатеричной строки в верхнем регистре (32 символа)
// - Возвращает null, если phrase равен null

// Примечания:
// - MD5 НЕ является криптографически безопасным для паролей
// - Используйте только для контрольных сумм или некритичного хеширования
```

---

## Класс Bech32

Статический класс, предоставляющий кодирование/декодирование Bech32 для блокчейн адресов.

### Encode

**Назначение**: Кодирует бинарные данные в формат Bech32 с указанным префиксом.

**Пример**:
```csharp
// Закодировать бинарные данные
byte[] data = new byte[] { 0x01, 0x02, 0x03, 0x04 };
string encoded = Bech32.Encode("init", data);
// Результат: "init1qypqxpq9qcrsszg"
```

**Разбор**:
```csharp
public static string Encode(string prefix, byte[] data)

// Параметры:
// - prefix: Человекочитаемый префикс (например, "init", "bc", "eth")
// - data: Бинарные данные для кодирования

// Возвращает:
// - Bech32-кодированную строку с контрольной суммой

// Примечания:
// - Преобразует 8-битные данные в 5-битный формат
// - Добавляет контрольную сумму из 6 символов
// - Префикс и данные разделены символом '1'
```

---

### Bech32ToHex

**Назначение**: Преобразует Bech32 адрес в шестнадцатеричный формат (специально для префикса "init").

**Пример**:
```csharp
// Преобразовать Bech32 в hex
string bech32 = "init1qypqxpq9qcrsszg2pgxysph3jf3j35z8";
string hex = Bech32.Bech32ToHex(bech32);
// Результат: "0x0102030405060708091011121314151617181920"
```

**Разбор**:
```csharp
public static string Bech32ToHex(string bech32Address)

// Параметры:
// - bech32Address: Корректный Bech32 адрес с префиксом "init"

// Возвращает:
// - Шестнадцатеричный адрес с префиксом "0x" (в нижнем регистре)

// Исключения:
// - ArgumentException: Если адрес пустой, неверного формата, неправильный префикс,
//   контрольная сумма не прошла проверку, или декодированные данные не равны 20 байтам

// Примечания:
// - Принимает только префикс "init"
// - Проверяет контрольную сумму
// - Ожидает ровно 20 байт декодированных данных
```

---

### HexToBech32

**Назначение**: Преобразует шестнадцатеричный адрес в формат Bech32.

**Пример**:
```csharp
// Преобразовать hex в Bech32
string hex = "0x0102030405060708091011121314151617181920";
string bech32 = Bech32.HexToBech32(hex);
// Результат: "init1qypqxpq9qcrsszg2pgxysph3jf3j35z8"

// С пользовательским префиксом
string customBech32 = Bech32.HexToBech32(hex, "eth");
```

**Разбор**:
```csharp
public static string HexToBech32(string hexAddress, string prefix = "init")

// Параметры:
// - hexAddress: Hex адрес с префиксом "0x" или без него
// - prefix: Префикс Bech32 (по умолчанию: "init")

// Возвращает:
// - Bech32-кодированный адрес с контрольной суммой

// Исключения:
// - ArgumentException: Если hex пустой, не 40 символов или содержит нешестнадцатеричные символы

// Примечания:
// - Принимает hex с префиксом "0x" или без него
// - Требует ровно 40 шестнадцатеричных символов (20 байт)
```

---

### Bech32ToBytes

**Назначение**: Декодирует Bech32 адрес в исходные байты с проверкой префикса.

**Пример**:
```csharp
// Декодировать Bech32 в байты
string bech32 = "init1qypqxpq9qcrsszg2pgxysph3jf3j35z8";
byte[] data = Bech32.Bech32ToBytes(bech32, "init");
// Результат: массив байтов декодированных данных
```

**Разбор**:
```csharp
public static byte[] Bech32ToBytes(string bech32Address, string expectedPrefix)

// Параметры:
// - bech32Address: Корректный Bech32 адрес
// - expectedPrefix: Ожидаемый префикс для валидации

// Возвращает:
// - Декодированный массив байтов (контрольная сумма удалена)

// Исключения:
// - ArgumentException: Если адрес пустой, неверного формата, неправильный префикс,
//   контрольная сумма не прошла проверку, или содержит недопустимые символы

// Примечания:
// - Проверяет, что префикс соответствует expectedPrefix (регистронезависимо)
// - Проверяет контрольную сумму
// - Возвращает данные без байтов контрольной суммы
```

---

## Класс Blake2b

Статический класс, предоставляющий криптографическое хеширование Blake2b.

### ComputeHash

**Назначение**: Вычисляет Blake2b хеш входных данных с настраиваемой длиной вывода.

**Пример**:
```csharp
// Вычислить 32-байтный хеш (по умолчанию)
byte[] input = Encoding.UTF8.GetBytes("Hello World");
byte[] hash = Blake2b.ComputeHash(input);

// Вычислить 64-байтный хеш
byte[] longHash = Blake2b.ComputeHash(input, 64);

// Вычислить 16-байтный хеш
byte[] shortHash = Blake2b.ComputeHash(input, 16);
```

**Разбор**:
```csharp
public static byte[] ComputeHash(byte[] input, int outLen = 32)

// Параметры:
// - input: Массив байтов для хеширования
// - outLen: Длина выходного хеша в байтах (по умолчанию: 32)

// Возвращает:
// - Blake2b хеш в виде массива байтов указанной длины

// Примечания:
// - Blake2b быстрее, чем SHA-256 и безопаснее, чем MD5
// - Поддерживает переменную длину вывода (обычно 1-64 байта)
// - Использует 12 раундов сжатия
// - Результат в формате little-endian
```

---
