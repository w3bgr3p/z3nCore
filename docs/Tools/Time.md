

## Time

### Назначение

Класс **Time** реализует вспомогательные методы для работы с временем и таймингом в проектах ZennoPoster: получение текущего времени в разных форматах, вычисление времени до конца дня или до указанного интервала, контроль таймаутов и возраста сессии, а также простые методы для ограничения времени выполнения задач.

### Примеры использования

```csharp
// Получить текущее время в формате Unix-эпохи (миллисекунды)
string unix = Time.Now(); // "unix" по умолчанию

// Получить текущее время в формате ISO 8601
string iso = Time.Now("iso");

// Время до конца дня в секундах (unix)
string tillEnd = Time.cd();

// Время через 10 минут от текущего момента (unix)
string future = Time.cd(10);

// Время через 1:30:00 (1 час 30 минут) в формате ISO
string futureIso = Time.cd("1:30:00", "iso");

// Получить возраст сессии в секундах
int age = project.TimeElapsed();

// Получить возраст сессии в виде строки (TimeSpan)
string ageStr = project.Age<string>();

// Проверить, не истёк ли глобальный таймаут (60 минут по умолчанию)
project.TimeOut();

// Проверить, не истёк ли таймаут с момента t0 (в секундах)
project.Deadline(120);
```


## Описание методов

### Now

```csharp
public static string Now(string format = "unix")
```

- **format**:
    - `"unix"` — возвращает время в миллисекундах с 1970-01-01 00:00:00 UTC (Unix Epoch, как строка).
    - `"iso"` — возвращает время в формате ISO 8601 (например, "2025-06-27T17:23:45.123Z").
    - `"short"` — возвращает короткий формат ("MM-ddTHH:mm").
- **Назначение:** Получение текущего времени в нужном формате.
- **Исключение:** Если формат не поддерживается.


### cd

```csharp
public static string cd(object input = null, string o = "unix")
```

- **input**:
    - `null` — время до конца текущего дня (23:59:59).
    - `int`/`decimal` — время через указанное число минут от текущего момента.
    - `string` (например, "1:30:00") — время через указанный интервал (TimeSpan).
- **o**:
    - `"unix"` — возвращает время в секундах с 1970-01-01 00:00:00 UTC.
    - `"iso"` — возвращает время в формате ISO 8601.
- **Назначение:** Получение времени до конца дня или через заданный интервал.
- **Исключение:** Если тип входного параметра не поддерживается.


### TimeElapsed

```csharp
public static int TimeElapsed(this IZennoPosterProjectModel project, string varName = "varSessionId")
```

- **varName**: имя переменной проекта с unix-временем старта (по умолчанию "varSessionId").
- **Назначение:** Возвращает количество секунд, прошедших с момента, записанного в переменной.


### Age

```csharp
public static T Age<T>(this IZennoPosterProjectModel project)
```

- **T**: тип возвращаемого значения (`int`, `string`, `TimeSpan`).
- **Назначение:** Возвращает возраст сессии:
    - В секундах (`int`/`long`)
    - В виде строки (`TimeSpan.ToString()`)
    - В виде объекта `TimeSpan`
- Если переменная не задана — инициализирует её текущим временем.


### TimeOut

```csharp
public static void TimeOut(this IZennoPosterProjectModel project, int min = 30)
```

- **min**: количество минут (по умолчанию 30).
- **Назначение:** Если возраст сессии больше `min` минут, выбрасывает исключение `"GlobalTimeout"`.


### Deadline

```csharp
public static void Deadline(this IZennoPosterProjectModel project, int sec = 0)
```

- **sec**: таймаут в секундах.
- **Назначение:**
    - При первом вызове сохраняет текущее время в переменную `t0`.
    - При последующих вызовах вычисляет разницу между текущим временем и `t0`.
    - Если разница превышает `sec`, выбрасывает исключение `"Timeout"`.


## Вспомогательные детали

- Все методы потокобезопасны (используется LockObject).
- Для работы с датой и временем используется только UTC.
- Форматы строго валидируются, ошибки выбрасываются с информативным сообщением.
- Для хранения времени старта используются переменные проекта (`varSessionId`, `t0`).


