

##  Converter

### Назначение

Класс **Converter** реализует универсальный статический метод для преобразования строк между различными форматами: hex, base64, bech32, bytes, text. Поддерживает автоматическую проверку формата входных и выходных данных, работу с адресами bech32 (с префиксом `init`), преобразование битовых массивов и логирование результата. Используется для конвертации ключей, адресов и других бинарных данных в проектах ZennoPoster.

### Пример использования

```csharp
// Конвертация приватного ключа из hex в base64
string base64 = Converter.ConvertFormat(project, "0x1234abcd...", "hex", "base64");

// Конвертация seed из base64 в bech32
string bech32 = Converter.ConvertFormat(project, "YmFzZTY0c3RyaW5n...", "base64", "bech32");

// Конвертация строки в hex
string hex = Converter.ConvertFormat(project, "example", "text", "hex", log: true);
```


## Описание метода

### ConvertFormat

```csharp
public static string ConvertFormat(
    IZennoPosterProjectModel project,
    string toProcess,
    string input,
    string output,
    bool log = false
)
```

- **toProcess**: строка для преобразования.
- **input**: формат входных данных (`"hex"`, `"base64"`, `"bech32"`, `"bytes"`, `"text"`).
- **output**: формат выходных данных (те же значения).
- **log**: логировать успешное преобразование.


#### Логика работы:

1. Приводит имена форматов к нижнему регистру.
2. Проверяет, что оба формата поддерживаются. Если нет — выбрасывает исключение.
3. Преобразует входную строку в массив байтов:
    - **hex**: убирает префикс `0x`, дополняет до 64 символов, проверяет валидность, конвертирует в байты.
    - **base64**: декодирует из base64.
    - **bech32**: декодирует, проверяет префикс `init`, преобразует в 32 байта.
    - **bytes**: интерпретирует строку как hex и конвертирует в байты.
    - **text**: кодирует строку в UTF-8.
4. Преобразует массив байтов в выходной формат:
    - **hex**: возвращает строку с префиксом `0x` и hex-представлением.
    - **base64**: кодирует в base64.
    - **bech32**: преобразует только если длина 32 байта, кодирует с префиксом `init`.
    - **bytes**: возвращает hex-строку без префикса.
    - **text**: декодирует байты в UTF-8 строку.
5. При ошибках выбрасывает информативные исключения (например, "Ожидался Bech32-адрес с префиксом 'init'", "Для Bech32 требуется 32 байта").
6. При успешном преобразовании и включённом логировании — отправляет сообщение в лог проекта.
7. В случае исключения — пишет ошибку в лог и возвращает null.

### Вспомогательные (внутренние) методы

- `DecodeBech32(string bech32)`: декодирует строку bech32, возвращает префикс и массив данных, проверяет контрольную сумму.
- `EncodeBech32(string hrp, byte[] data)`: кодирует массив байтов в строку bech32 с нужным префиксом.
- `ConvertBits(byte[] data, int fromBits, int toBits, bool pad)`: преобразует массив байтов из одного битового формата в другой (например, из 8 бит в 5 бит для bech32).
- `VerifyChecksum(string hrp, string data)`, `CreateChecksum(string hrp, byte[] data)`, `Polymod(List<byte> values)`: реализация проверки и генерации контрольной суммы bech32.


